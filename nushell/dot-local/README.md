# Nushell Data Files

This directory contains Nushell data files that should reside in `~/.local/share/nushell/` (when `XDG_DATA_HOME` is set).

## Structure

```
dot-local/share/
└── nushell/
    └── vendor/autoload/
        └── starship.nu        # Starship prompt (stow-managed)
```

## Starship

**File**: `nushell/vendor/autoload/starship.nu`

This file is automatically generated and stow-managed:
- Stow creates: `~/.local/share/nushell` → `dotfiles/nushell/dot-local/share/nushell`
- Nushell auto-loads from: `$nu.data-dir/vendor/autoload/starship.nu`
- To regenerate: `starship init nu > nushell/dot-local/share/nushell/vendor/autoload/starship.nu`

## Atuin

**Template**: `templates/atuin-init.nu`

This file is maintained as a **template** in `nushell/templates/` and must be copied manually to `~/.local/share/atuin/`:

```bash
cp nushell/templates/atuin-init.nu ~/.local/share/atuin/init.nu
```

**Why manual copy?**

The `~/.local/share/atuin/` directory contains user-specific data (history database, sync state, etc.) that should not be managed by stow. We can't symlink files into this directory without conflicts.

**Regenerating the template**:
```bash
ATUIN_NOBIND=true atuin init nu > nushell/templates/atuin-init.nu
```

The `ATUIN_NOBIND=true` environment variable prevents Atuin from setting its own keybindings, allowing us to configure Ctrl+R in `config.nu`.

## XDG Data Directory

After XDG_DATA_HOME is set (via `env.d/01-env-darwin.nu` on macOS), Nushell will use:
- `$nu.data-dir` = `~/.local/share/nushell/`

Before XDG variables are set, macOS Nushell defaults to:
- `~/Library/Application Support/nushell/`

This is why a complete terminal restart is needed after first installation - to ensure XDG variables are available before Nushell starts.
